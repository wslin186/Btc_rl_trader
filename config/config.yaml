# ================================================================
# 📁  btc_rl_trader / config /config.yaml
# ================================================================

# ------------------------------------------------------------------
# 1️⃣  数据下载
# ------------------------------------------------------------------
download:
  trading_type:  spot
  symbols:      ["BTCUSDT"]
  intervals:    ["1h"]
  start_date:    2017-08-01
  end_date:      2025-04-30
  skip_monthly:  0
  skip_daily:    1
  checksum:      0
  threads:       8
  frequency:     "@daily"       # 可选
  enable_cron:   false

# ------------------------------------------------------------------
# 2️⃣  数据集区间 / 路径
# ------------------------------------------------------------------
data:
  processed_path: data/processed/btc.parquet

  train_start:  2017-08-01
  train_end:    2023-12-31
  test_start:   2024-01-01
  test_end:     2025-04-30

  train_ratio:  null            # 显式区间时保持 null

# ------------------------------------------------------------------
# 3️⃣  环境参数
# ------------------------------------------------------------------
env:
  window_size: 100         # 增加观察窗口大小
  init_cash:   100000
  fee:         0.0004
  slippage:    0.0002
  reward_scale: 200        # 放大对数回报
  action_reward: 0.5     # 动作切换额外奖励
  trade_penalty: 0.0001     # 交易惩罚
  sharpe_coef: 0.2        # 夏普比率奖励系数

# ------------------------------------------------------------------
# 4️⃣  PPO 基础超参
# ------------------------------------------------------------------
ppo:
  policy:          MlpPolicy
  total_timesteps: 2_000_000
  n_steps:         512
  batch_size:      128
  learning_rate:   0.0001
  gamma:           0.99
  gae_lambda:      0.95
  ent_coef:        0.1            # 增加熵系数促进更多探索
  vf_coef:         0.5
  clip_range:      0.2
  max_grad_norm:   0.5
  n_epochs:        8              # 增加每批次训练轮数
  total_timesteps: 2000000 # 增加训练时间步
  target_kl:       0.01
  verbose:         1
  tensorboard_log: logs/tb
  seed:            42
  device:          auto

# ------------------------------------------------------------------
# 5️⃣  并行训练（SubprocVecEnv）
# ------------------------------------------------------------------
training:
  n_envs:          8            # 并行环境数
  n_steps:         512          # 每环境样本数 => 8*512=4096
  total_timesteps: 2_000_000
  eval_episodes:   20           # 评估回合数

# ------------------------------------------------------------------
# 6️⃣  模型与日志路径
# ------------------------------------------------------------------
paths:
  model_dir:  models
  model_name: ppo_btc_latest.zip

tensorboard:
  enable:  true
  log_dir: logs/tb
  host:    127.0.0.1
  port:    6006
